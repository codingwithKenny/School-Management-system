"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5177],{59647:(e,s,a)=>{a.d(s,{DatabaseProvider:()=>n,t:()=>o});var r=a(95155),t=a(12115),l=a(75828);let c=(0,l.createServerReference)("008a7ca980c81f6515d34e48945911d00e5f7e24e0",l.callServer,void 0,l.findSourceMapURL,"getDatabaseData"),d=(0,t.createContext)(),n=e=>{let{children:s}=e,[a,l]=(0,t.useState)({sessions:[],grades:[],classes:[],subjects:[],parents:[],teachers:[],term:[],paymentHistory:[],studentHistory:[],student:[]}),[n,o]=(0,t.useState)(!0),[i,u]=(0,t.useState)(null);return(0,t.useEffect)(()=>{(async function(){console.log("\uD83D\uDFE1 Fetching database data...");let e=await c();e.success?l(e.data):u(e.error),o(!1)})()},[]),(0,r.jsx)(d.Provider,{value:{databaseData:a,loading:n,error:i},children:s})},o=()=>(0,t.useContext)(d)},15177:(e,s,a)=>{a.r(s),a.d(s,{default:()=>o});var r=a(95155),t=a(69606),l=a(12115),c=a(59647),d=a(96065),n=a(76046);let o=e=>{let{type:s,data:a,memoizedClasses:o,setOpen:i}=e,{databaseData:u,loading:h}=(0,c.t)(),m=u.teachers||[],[g,x]=(0,l.useState)(!1),{register:p,handleSubmit:f,setValue:b,formState:{errors:v}}=(0,t.mN)(),[j,S]=(0,l.useState)(null),N=(0,n.useRouter)();console.log(o,"class data available"),(0,l.useEffect)(()=>{j&&b("classId",j)},[j,b]);let[y,w]=(0,l.useState)({success:!1,error:!1,errorMessage:""}),C=f(async e=>{console.log("\uD83D\uDCCC Form Submitted:",e),x(!0);try{let s=await (0,d._)(e);(null==s?void 0:s.success)?w({success:!0,error:!1,errorMessage:""}):w({success:!1,error:!0,errorMessage:(null==s?void 0:s.error)||"Error occurred"})}catch(e){w({success:!1,error:!0,errorMessage:"An unexpected error occurred."})}});return(0,l.useEffect)(()=>{y.success&&setTimeout(()=>{i(!1),N.refresh()},500)},[y.success]),(0,r.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:C,children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:"create"===s?"Assign Class Teacher":"Update Assigned Class Teacher"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),(0,r.jsxs)("select",{...p("classId"),className:"w-full p-2 border rounded-md bg-gray-100",onChange:e=>S(parseInt(e.target.value,10)),children:[(0,r.jsx)("option",{value:"",children:"Select Class"}),(null==o?void 0:o.length)>0?o.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id)):(0,r.jsx)("option",{disabled:!0,children:"No classes available"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Teacher"}),(0,r.jsxs)("select",{...p("teacherId"),className:"w-full p-2 border rounded-md bg-gray-100",children:[(0,r.jsx)("option",{value:"",children:"Select Teacher"}),h?(0,r.jsx)("option",{disabled:!0,children:"Loading..."}):m.length>0?m.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," ",e.surname]},e.id)):(0,r.jsx)("option",{disabled:!0,children:"No teachers available"})]})]}),y.success&&(0,r.jsxs)("p",{className:"text-green-500",children:["Teacher ","create"===s?"assigned":"updated"," successfully!"]}),y.error&&(0,r.jsx)("p",{className:"text-red-500",children:y.errorMessage||"Something went wrong."}),(0,r.jsx)("button",{type:"submit",className:"bg-purple-400 rounded-md text-white p-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:g,children:g?"saving":"create"===s?"Assign":"Update"})]})}},96065:(e,s,a)=>{a.d(s,{_:()=>t});var r=a(75828);let t=(0,r.createServerReference)("4058ec963f03d2831514d001901310ff848301da6d",r.callServer,void 0,r.findSourceMapURL,"assignClassTeacher")}}]);