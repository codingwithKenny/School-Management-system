"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5341],{45341:(e,s,r)=>{r.r(s),r.d(s,{default:()=>o});var t=r(95155),a=r(69606),n=r(85060),i=r(27301),m=r(35193),u=r(96332),l=r(24627),c=r(12115),d=r(76046);let o=e=>{var s;let{type:r,data:o,setOpen:g}=e,[b,p]=(0,c.useState)(!1),h=(0,d.useRouter)(),{register:x,handleSubmit:f,setValue:j,formState:{errors:S}}=(0,a.mN)({resolver:(0,n.u)(m.subjectSchema)}),N=(null==o?void 0:null===(s=o.teachers)||void 0===s?void 0:s.length)>0?o.teachers.map(e=>"".concat(e.teacher.name," ").concat(e.teacher.surname)).join(", "):"No assigned teacher",[v,y]=(0,c.useState)({success:!1,error:!1,errorMessage:""}),I=f(async e=>{console.log("Form Submitted:",e),p(!0);try{let s;if("create"===r)s=await (0,u.F)(e);else if("update"===r&&(null==o?void 0:o.id))s=await (0,l.i)(o.id,e);else{y({success:!1,error:!0,errorMessage:"Invalid subject ID."});return}s.success?y({success:!0,error:!1,errorMessage:""}):y({success:!1,error:!0,errorMessage:s.error})}catch(e){y({success:!1,error:!0,errorMessage:"An unexpected error occurred."})}});return(0,c.useEffect)(()=>{v.success&&setTimeout(()=>{g(!1),h.refresh()},500)},[v.success]),(0,t.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:I,children:[(0,t.jsx)("h1",{className:"text-xl font-semibold",children:"create"===r?"Create New Subject":"Update Subject"}),(0,t.jsx)("div",{className:"flex flex-wrap justify-between gap-2",children:(0,t.jsx)(i.A,{label:"Subject Name",name:"name",register:x,error:S.name,defaultValue:null==o?void 0:o.name})}),"create"===r?(0,t.jsx)("p",{className:"text-sm text-purple-500",children:"Teacher will be assigned shortly, go ahead and create a new subject."}):(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Teacher"}),(0,t.jsx)("input",{type:"text",...x("teacherName"),defaultValue:N,className:"w-full p-2 border rounded-md bg-gray-100",readOnly:!0}),(0,t.jsx)("input",{type:"hidden",...x("teacherId")})]}),v.success&&(0,t.jsxs)("p",{className:"text-green-500",children:["Subject ","create"===r?"created":"updated"," successfully!"]}),v.error&&(0,t.jsx)("p",{className:"text-red-500",children:v.errorMessage||"Something went wrong."}),(0,t.jsx)("button",{type:"submit",className:"bg-purple-400 rounded-md text-white p-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:b,children:b?"Saving...":"create"===r?"Create":"Update"})]})}},27301:(e,s,r)=>{r.d(s,{A:()=>a});var t=r(95155);r(12115);let a=e=>{let{label:s,type:r,register:a,name:n,defaultValue:i,error:m,disabled:u,inputProps:l}=e;return(0,t.jsxs)("div",{className:"flex flex-col gap-2 w-full md:w-1/4",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:s}),(0,t.jsx)("input",{type:r,...a(n),disabled:u,className:"ring-[1.5px] ring-gray-300 rounded-md p-2 text-sm ",...l,defaultValue:i}),(null==m?void 0:m.message)&&(0,t.jsx)("p",{className:"text-red-400 text-xs",children:null==m?void 0:m.message.toString()})]})}},35193:(e,s,r)=>{let{z:t}=r(70828),a=t.object({id:t.number().optional(),name:t.string().min(3,{message:"Subject must be at least 3 characters!"})}),n=t.object({id:t.string().optional(),surname:t.string().min(5,{message:"Surname must be at least 5 characters!"}),name:t.string().min(2,{message:"Name must be at least 2 characters!"}),username:t.string().min(3,{message:"Username must be at least 3 characters!"}),email:t.string().email({message:"Invalid email format!"}),img:t.string().optional(),phone:t.string().regex(/^\d{7,15}$/,"Enter a valid phone number (7-15 digits)").optional(),password:t.string().min(9,{message:"Password must be at least 9 characters!"}),sex:t.enum(["MALE","FEMALE"],{message:"Select your gender"}),address:t.string().optional(),subjects:t.array(t.union([t.string(),t.number()])).min(1,{message:"At least one subject must be selected"}).transform(e=>e.map(Number))}),i=t.object({id:t.string().optional(),surname:t.string().min(2,{message:"Surname is required"}),firstname:t.string().min(2,{message:"Name is required"}),admission:t.string().min(3,{message:"Admission number is required"}),sex:t.enum(["MALE","FEMALE"],{message:"Select your gender"}),img:t.string().optional(),phone:t.string().regex(/^\d{7,15}$/,"Enter a valid phone number (7-15 digits)").optional(),address:t.string().optional(),sessionId:t.union([t.string(),t.number()]).transform(e=>Number(e)),termId:t.union([t.string(),t.number()]).transform(e=>Number(e)),gradeId:t.union([t.string(),t.number()]).transform(e=>Number(e)),classId:t.union([t.string(),t.number()]).transform(e=>Number(e)),paymentStatus:t.enum(["PAID","NOT_PAID","PARTIALLY_PAID"],{message:"Select payment status"}),subjects:t.array(t.union([t.string(),t.number()])).min(1,{message:"At least one subject must be selected"}).transform(e=>e.map(Number))}),m=t.object({studentId:t.string().nonempty("Student ID is required"),teacherId:t.string().nonempty("Teacher ID is required"),termId:t.number().min(1,"Term is required"),sessionId:t.number().min(1,"Session is required"),classId:t.number().min(1,"Class is required"),remark:t.string().trim().min(1,"Remark cannot be empty"),position:t.number().min(1,"Position must be greater than 0"),promotion:t.string().optional()});e.exports={studentSchema:i,teacherSchema:n,subjectSchema:a,recordSchema:m}},24627:(e,s,r)=>{r.d(s,{i:()=>a});var t=r(75828);let a=(0,t.createServerReference)("7f313469743f7fd3702663b6525ad8630a911241aa",t.callServer,void 0,t.findSourceMapURL,"updateSubject")},96332:(e,s,r)=>{r.d(s,{F:()=>a});var t=r(75828);let a=(0,t.createServerReference)("7ff0ad8b0367d26620e1348595599f94b06fd8d743",t.callServer,void 0,t.findSourceMapURL,"createSubject")}}]);