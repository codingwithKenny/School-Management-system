(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1670],{53252:(e,t,s)=>{Promise.resolve().then(s.bind(s,39085)),Promise.resolve().then(s.bind(s,2980))},76046:(e,t,s)=>{"use strict";var a=s(66658);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSelectedLayoutSegments")&&s.d(t,{useSelectedLayoutSegments:function(){return a.useSelectedLayoutSegments}})},75828:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{callServer:function(){return a.callServer},createServerReference:function(){return n},findSourceMapURL:function(){return r.findSourceMapURL}});let a=s(89603),r=s(33355),n=s(34979).createServerReference},59647:(e,t,s)=>{"use strict";s.d(t,{DatabaseProvider:()=>d,t:()=>i});var a=s(95155),r=s(12115),n=s(75828);let l=(0,n.createServerReference)("008a7ca980c81f6515d34e48945911d00e5f7e24e0",n.callServer,void 0,n.findSourceMapURL,"getDatabaseData"),o=(0,r.createContext)(),d=e=>{let{children:t}=e,[s,n]=(0,r.useState)({sessions:[],grades:[],classes:[],subjects:[],parents:[],teachers:[],term:[],paymentHistory:[],studentHistory:[],student:[]}),[d,i]=(0,r.useState)(!0),[c,u]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async function(){console.log("\uD83D\uDFE1 Fetching database data...");let e=await l();e.success?n(e.data):u(e.error),i(!1)})()},[]),(0,a.jsx)(o.Provider,{value:{databaseData:s,loading:d,error:c},children:t})},i=()=>(0,r.useContext)(o)},39085:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(95155),r=s(59647),n=s(99398),l=s(32286),o=s(12115);let d=()=>{let{databaseData:e}=(0,r.t)(),[t,s]=(0,o.useState)(null),[d,i]=(0,o.useState)(null),[c,u]=(0,o.useState)([]),m=e.sessions,h=t?e.terms.filter(e=>Number(e.sessionId)===Number(t)):[];(0,o.useEffect)(()=>{if(!e.paymentHistory||0===e.paymentHistory.length){console.log("Payment history is empty or not loaded yet.");return}console.log("Fetching students for session:",t,"and term:",d);let s=e.paymentHistory.filter(e=>Number(e.sessionId)===Number(t)&&Number(e.termId)===Number(d)).map(t=>{let s=e.student.find(e=>e.id===t.studentId);return s?{id:s.id,name:"".concat(s.firstname," ").concat(s.surname),status:t.status}:null}).filter(Boolean);console.log("Filtered students:",s),u(s)},[t,d,e.paymentHistory]);let f=(e,t)=>{u(s=>s.map(s=>s.id===e?{...s,status:t}:s))},p=async(e,s)=>{console.log("Updating payment status for:",e,"to",s,"for session",t,"and term",d);try{let a=await (0,l.w)({studentId:e,sessionId:t,termId:d,newStatus:s});console.log(a),a.success&&(0,n.oR)({description:"Payment status updated successfully.",variant:"destructive"})}catch(e){(0,n.oR)({description:"Error updating result.",variant:"destructive"})}};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Select Session"}),(0,a.jsxs)("select",{className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",value:t||"",onChange:e=>s(parseInt(e.target.value,10)),children:[(0,a.jsx)("option",{value:"",children:"-- Select Session --"}),m.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),t&&(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Select Term"}),(0,a.jsxs)("select",{className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",value:d||"",onChange:e=>i(parseInt(e.target.value,10)),children:[(0,a.jsx)("option",{value:"",children:"-- Select Term --"}),h.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),d&&c.length>0&&(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Student Payment Status"}),(0,a.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-100",children:[(0,a.jsx)("th",{className:"border p-2",children:"Student Name"}),(0,a.jsx)("th",{className:"border p-2",children:"Payment Status"}),(0,a.jsx)("th",{className:"border p-2",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:c.map(e=>(0,a.jsxs)("tr",{className:"text-center",children:[(0,a.jsx)("td",{className:"border p-2",children:e.name}),(0,a.jsx)("td",{className:"border p-2",children:(0,a.jsxs)("select",{className:"p-1 border rounded",value:e.status,onChange:t=>f(e.id,t.target.value),children:[(0,a.jsx)("option",{value:"PAID",children:"PAID"}),(0,a.jsx)("option",{value:"NOT_PAID",children:"UNPAID"}),(0,a.jsx)("option",{value:"PARTIALLY_PAID",children:"PARTIALLY PAID"})]})}),(0,a.jsx)("td",{className:"border p-2",children:(0,a.jsx)("button",{className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",onClick:()=>p(e.id,e.status),children:"Save"})})]},e.id))})]})]}),d&&0===c.length&&(0,a.jsx)("p",{className:"text-gray-500 text-sm mt-4",children:"No students found for this term."})]})}},2980:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(95155),r=s(64136),n=s(5565),l=s(76046),o=s(12115);let d=e=>{let{session:t}=e,[s,d]=(0,o.useState)(!1),[i,c]=(0,o.useState)(""),[u,m]=(0,o.useState)(""),[h,f]=(0,o.useState)(!1),p=(0,l.useRouter)(),b=async()=>{if(!i.trim()){m("Session name cannot be empty.");return}let e=t.id;f(!0);let s=await (0,r.q)(e,i);if(console.log(e,i),s.success&&p.refresh(),console.log(s),!s.success){m(s.message),f(!1);return}f(!1),d(!1),c("")};return(0,a.jsxs)("div",{className:"mt-10",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Current Session"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-10 items-center justify-center bg-white p-4 rounded-2xl shadow-lg w-80 max-w-full",children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)("button",{className:"bg-white text-green-600 text-sm p-2 font-bold rounded-lg shadow-md",children:null==t?void 0:t.name}),(0,a.jsx)("button",{onClick:()=>d(!0),className:"p-2 rounded-md bg-blue-200 hover:bg-blue-300 transition",children:(0,a.jsx)(n.default,{src:"/update.png",alt:"update",width:24,height:24})})]})}),s&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-[90%] sm:w-[50%] lg:w-[40%] shadow-xl",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Update Session"}),(0,a.jsx)("input",{type:"text",placeholder:"Enter Session Name (e.g., 2025/2026)",defaultValue:null==t?void 0:t.name,onChange:e=>c(e.target.value),className:"w-full border p-2 rounded-md mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400"}),u&&(0,a.jsx)("p",{className:"text-red-500 text-sm mb-4",children:u}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{className:"bg-gray-300 px-4 py-2 rounded-md hover:bg-gray-400 transition",onClick:()=>d(!1),children:"Cancel"}),(0,a.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md transition ".concat(h?"opacity-50 cursor-not-allowed":"hover:bg-blue-700"),onClick:b,disabled:h,children:h?"updating...":"Update"})]})]})})]})}},99398:(e,t,s)=>{"use strict";s.d(t,{dj:()=>m,oR:()=>u});var a=s(12115);let r=0,n=new Map,l=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?l(s):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],i={toasts:[]};function c(e){i=o(i,e),d.forEach(e=>{e(i)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=a.useState(i);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},32286:(e,t,s)=>{"use strict";s.d(t,{w:()=>r});var a=s(75828);let r=(0,a.createServerReference)("7f0ddba15a4d1a2b5818152aedeee1babfecfaf880",a.callServer,void 0,a.findSourceMapURL,"updatePaymentHistory")},64136:(e,t,s)=>{"use strict";s.d(t,{q:()=>r});var a=s(75828);let r=(0,a.createServerReference)("7f1eb12a3ad3fca310f6993f174cc939657ac976b3",a.callServer,void 0,a.findSourceMapURL,"updateSession")}},e=>{var t=t=>e(e.s=t);e.O(0,[5565,8441,1517,7358],()=>t(53252)),_N_E=e.O()}]);