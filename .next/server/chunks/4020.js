"use strict";exports.id=4020,exports.ids=[4020],exports.modules={94020:(e,s,r)=>{r.r(s),r.d(s,{default:()=>b});var t=r(45512),a=r(58009),n=r(6868),i=r(81914),l=r(91379),m=r(16249),d=r(77062),o=r(9072),c=r(45103),u=r(20055),g=r(39260),x=r(30999);let b=({type:e,data:s})=>{let{databaseData:r}=(0,x.t)(),[b,p]=(0,a.useState)(null),[f,j]=(0,a.useState)(s?.img||""),[h,S]=(0,a.useState)(""),{register:N,handleSubmit:A,setValue:v,reset:y,control:w,formState:{errors:I}}=(0,n.mN)({resolver:(0,i.u)(m.teacherSchema),defaultValues:{...s,subjects:s?.subjects?.map(e=>String(e.subjectId))||[]}});(0,a.useEffect)(()=>{s&&(y({...s,sex:s?.sex||"",phone:s?.phone||"",img:s?.img||"",subjects:s?.subjects?.map(e=>String(e.subjectId))||[]}),v("sex",s?.sex||""),v("phone",s?.phone||""),v("img",s?.img||""),v("subjects",s?.subjects?.map(e=>String(e.subjectId))||[]))},[s,y,v]);let E=A(async r=>{console.log("Form Submitted:",r);try{let t;let a={...r,subjects:r.subjects.map(e=>Number(e)),img:r.img||f?.secure_url||s?.img};if(console.log("Request Data:",a),"create"===e)t=await (0,d.j)(a);else if("update"===e&&s?.id)t=await (0,o.S)(s.id,a);else{console.error("No teacher ID found for update.");return}if(console.log("Response:",t),t.success)p({type:"success",text:"create"===e?"Admin created successfully!":"Teacher updated successfully!"}),setTimeout(()=>{window.location.reload()},2e3);else throw Error(t.error||"Unknown error occurred.")}catch(e){console.error("Error submitting form:",e),S("An unexpected error occurred. Please try again.")}});return(0,a.useEffect)(()=>{console.log("Received data:",s)},[s]),(0,t.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:A(E),children:[(0,t.jsx)("h1",{className:"text-xl font-semibold",children:"create"===e?"Add New Admin":"Update Admin"}),b&&(0,t.jsx)("div",{className:`p-3 rounded-md text-sm ${"success"===b.type?"bg-green-100 text-green-700 border border-green-400":"bg-red-100 text-red-700 border border-red-400"}`,children:b.text}),(0,t.jsxs)("div",{className:"flex flex-wrap justify-between gap-2",children:[(0,t.jsx)(l.A,{label:"Surname",name:"surname",register:N,error:I.surname}),(0,t.jsx)(l.A,{label:"Name",name:"name",register:N,error:I.name}),(0,t.jsx)(l.A,{label:"Username",name:"username",register:N,error:I.username}),(0,t.jsx)(l.A,{label:"Email",name:"email",register:N,error:I.email}),(0,t.jsx)(l.A,{label:"Password",name:"password",type:"password",register:N,error:I.password}),(0,t.jsx)(l.A,{label:"Address",name:"address",register:N,error:I.address})]}),(0,t.jsxs)("div",{className:"flex gap-5 items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-col w-full md:w-1/4",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:"Sex"}),(0,t.jsxs)("select",{...N("sex"),defaultValue:s?.sex||"",children:[(0,t.jsx)("option",{value:"",children:"Select gender"}),(0,t.jsx)("option",{value:"MALE",children:"Male"}),(0,t.jsx)("option",{value:"FEMALE",children:"Female"})]}),I.sex&&(0,t.jsx)("p",{className:"text-red-500 text-xs",children:I.sex.message})]}),(0,t.jsx)(l.A,{label:"phone",name:"phone",register:N,error:I.address}),(0,t.jsx)(u.A,{name:"subjects",label:"Subjects",control:w,options:r?.subjects||[],multiple:!0,placeholder:"-- Select Subjects --",error:I.subjects})]}),(0,t.jsx)(g.bo,{uploadPreset:"MuslimSchool",onSuccess:(e,{widget:s})=>{j(e.info.secure_url),v("img",e.info.secure_url),s.close()},children:({open:e})=>(0,t.jsxs)("div",{className:"text-xs text-gray-500 flex items-center cursor-pointer gap-2",onClick:()=>e(),children:[(0,t.jsx)(c.default,{src:f||s?.img||"/avatar.png",alt:"Upload",width:28,height:28}),(0,t.jsx)("span",{children:"Upload Image"})]})}),(0,t.jsx)("button",{type:"submit",className:"bg-purple-400 rounded-md text-white p-2",children:"create"===e?"Add Admin":"Update"})]})}},91379:(e,s,r)=>{r.d(s,{A:()=>a});var t=r(45512);r(58009);let a=({label:e,type:s,register:r,name:a,defaultValue:n,error:i,disabled:l,inputProps:m})=>(0,t.jsxs)("div",{className:"flex flex-col gap-2 w-full md:w-1/4",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:e}),(0,t.jsx)("input",{type:s,...r(a),disabled:l,className:"ring-[1.5px] ring-gray-300 rounded-md p-2 text-sm ",...m,defaultValue:n}),i?.message&&(0,t.jsx)("p",{className:"text-red-400 text-xs",children:i?.message.toString()})]})},20055:(e,s,r)=>{r.d(s,{A:()=>i});var t=r(45512),a=r(58009),n=r(6868);let i=({name:e,label:s,options:r=[],control:i,multiple:l=!1,placeholder:m="-- Select Option --"})=>{let{field:{value:d,onChange:o},fieldState:{error:c}}=(0,n.as)({name:e,control:i}),[u,g]=(0,a.useState)(d||(l?[]:""));(0,a.useEffect)(()=>{d&&g(d)},[]);let x=e=>{if(l){let s=u.filter(s=>s!==e);g(s),o(s)}};return(0,t.jsxs)("div",{className:"flex flex-col w-full md:w-1/4",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:s}),(0,t.jsxs)("select",{className:"border text-sm text-gray-500 mt-2 ring-[1.5px] ring-gray-300 rounded-md p-2 text-sm",onChange:e=>{let s=String(e.target.value);if(l&&!u.includes(s)){let e=[...u,s];g(e),o(e)}},children:[(0,t.jsx)("option",{value:"",children:m}),r.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]}),l&&u.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2 ",children:u.map((e,s)=>{let a=r.find(s=>String(s.id)===e);return(0,t.jsxs)("span",{className:"bg-gray-200 rounded-md text-[8px] flex items-center",children:[a?.name||"Unknown",(0,t.jsx)("button",{type:"button",className:"ml-2 text-red-500 font-bold",onClick:()=>x(e),children:"\xd7"})]},`${e}-${s}`)})}),c&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:c.message})]})}},16249:(e,s,r)=>{let{z:t}=r(99878),a=t.object({id:t.number().optional(),name:t.string().min(3,{message:"Subject must be at least 3 characters!"})}),n=t.object({id:t.string().optional(),surname:t.string().min(5,{message:"Surname must be at least 5 characters!"}),name:t.string().min(2,{message:"Name must be at least 2 characters!"}),username:t.string().min(3,{message:"Username must be at least 3 characters!"}),email:t.string().email({message:"Invalid email format!"}),img:t.string().optional(),phone:t.string().regex(/^\d{7,15}$/,"Enter a valid phone number (7-15 digits)").optional(),password:t.string().min(9,{message:"Password must be at least 9 characters!"}),sex:t.enum(["MALE","FEMALE"],{message:"Select your gender"}),address:t.string().optional(),subjects:t.array(t.union([t.string(),t.number()])).min(1,{message:"At least one subject must be selected"}).transform(e=>e.map(Number))}),i=t.object({id:t.string().optional(),surname:t.string().min(2,{message:"Surname is required"}),firstname:t.string().min(2,{message:"Name is required"}),admission:t.string().min(3,{message:"Admission number is required"}),sex:t.enum(["MALE","FEMALE"],{message:"Select your gender"}),img:t.string().optional(),phone:t.string().regex(/^\d{7,15}$/,"Enter a valid phone number (7-15 digits)").optional(),address:t.string().optional(),sessionId:t.union([t.string(),t.number()]).transform(e=>Number(e)),termId:t.union([t.string(),t.number()]).transform(e=>Number(e)),gradeId:t.union([t.string(),t.number()]).transform(e=>Number(e)),classId:t.union([t.string(),t.number()]).transform(e=>Number(e)),paymentStatus:t.enum(["PAID","NOT_PAID","PARTIALLY_PAID"],{message:"Select payment status"}),subjects:t.array(t.union([t.string(),t.number()])).min(1,{message:"At least one subject must be selected"}).transform(e=>e.map(Number))}),l=t.object({studentId:t.string().nonempty("Student ID is required"),teacherId:t.string().nonempty("Teacher ID is required"),termId:t.number().min(1,"Term is required"),sessionId:t.number().min(1,"Session is required"),classId:t.number().min(1,"Class is required"),remark:t.string().trim().min(1,"Remark cannot be empty"),position:t.number().min(1,"Position must be greater than 0"),promotion:t.string().optional()});e.exports={studentSchema:i,teacherSchema:n,subjectSchema:a,recordSchema:l}},9072:(e,s,r)=>{r.d(s,{S:()=>a});var t=r(26248);let a=(0,t.createServerReference)("7f83a0c169bd936e319b22b5fb8e983c6a78b17519",t.callServer,void 0,t.findSourceMapURL,"updateTeacher")},77062:(e,s,r)=>{r.d(s,{j:()=>a});var t=r(26248);let a=(0,t.createServerReference)("7ff9f4b3c0899f1ff57e9b8920f38fba9736beb4d9",t.callServer,void 0,t.findSourceMapURL,"createTeacher")}};