"use strict";exports.id=3889,exports.ids=[3889],exports.modules={16270:(e,s,r)=>{r.r(s),r.d(s,{default:()=>l});var t=r(45512),a=r(6868),n=r(81914),i=r(91379),m=r(16249),d=r(45073),u=r(76386),c=r(58009),o=r(79334);let l=({type:e,data:s,setOpen:r})=>{let[l,g]=(0,c.useState)(!1),b=(0,o.useRouter)(),{register:p,handleSubmit:x,setValue:h,formState:{errors:f}}=(0,a.mN)({resolver:(0,n.u)(m.subjectSchema)}),j=s?.teachers?.length>0?s.teachers.map(e=>`${e.teacher.name} ${e.teacher.surname}`).join(", "):"No assigned teacher",[S,N]=(0,c.useState)({success:!1,error:!1,errorMessage:""}),y=x(async r=>{console.log("Form Submitted:",r),g(!0);try{let t;if("create"===e)t=await (0,d.F)(r);else if("update"===e&&s?.id)t=await (0,u.i)(s.id,r);else{N({success:!1,error:!0,errorMessage:"Invalid subject ID."});return}t.success?N({success:!0,error:!1,errorMessage:""}):N({success:!1,error:!0,errorMessage:t.error})}catch(e){N({success:!1,error:!0,errorMessage:"An unexpected error occurred."})}});return(0,c.useEffect)(()=>{S.success&&setTimeout(()=>{r(!1),b.refresh()},500)},[S.success]),(0,t.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:y,children:[(0,t.jsx)("h1",{className:"text-xl font-semibold",children:"create"===e?"Create New Subject":"Update Subject"}),(0,t.jsx)("div",{className:"flex flex-wrap justify-between gap-2",children:(0,t.jsx)(i.A,{label:"Subject Name",name:"name",register:p,error:f.name,defaultValue:s?.name})}),"create"===e?(0,t.jsx)("p",{className:"text-sm text-purple-500",children:"Teacher will be assigned shortly, go ahead and create a new subject."}):(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Teacher"}),(0,t.jsx)("input",{type:"text",...p("teacherName"),defaultValue:j,className:"w-full p-2 border rounded-md bg-gray-100",readOnly:!0}),(0,t.jsx)("input",{type:"hidden",...p("teacherId")})]}),S.success&&(0,t.jsxs)("p",{className:"text-green-500",children:["Subject ","create"===e?"created":"updated"," successfully!"]}),S.error&&(0,t.jsx)("p",{className:"text-red-500",children:S.errorMessage||"Something went wrong."}),(0,t.jsx)("button",{type:"submit",className:"bg-purple-400 rounded-md text-white p-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l,children:l?"Saving...":"create"===e?"Create":"Update"})]})}},91379:(e,s,r)=>{r.d(s,{A:()=>a});var t=r(45512);r(58009);let a=({label:e,type:s,register:r,name:a,defaultValue:n,error:i,disabled:m,inputProps:d})=>(0,t.jsxs)("div",{className:"flex flex-col gap-2 w-full md:w-1/4",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:e}),(0,t.jsx)("input",{type:s,...r(a),disabled:m,className:"ring-[1.5px] ring-gray-300 rounded-md p-2 text-sm ",...d,defaultValue:n}),i?.message&&(0,t.jsx)("p",{className:"text-red-400 text-xs",children:i?.message.toString()})]})},16249:(e,s,r)=>{let{z:t}=r(99878),a=t.object({id:t.number().optional(),name:t.string().min(3,{message:"Subject must be at least 3 characters!"})}),n=t.object({id:t.string().optional(),surname:t.string().min(5,{message:"Surname must be at least 5 characters!"}),name:t.string().min(2,{message:"Name must be at least 2 characters!"}),username:t.string().min(3,{message:"Username must be at least 3 characters!"}),email:t.string().email({message:"Invalid email format!"}),img:t.string().optional(),phone:t.string().regex(/^\d{7,15}$/,"Enter a valid phone number (7-15 digits)").optional(),password:t.string().min(9,{message:"Password must be at least 9 characters!"}),sex:t.enum(["MALE","FEMALE"],{message:"Select your gender"}),address:t.string().optional(),subjects:t.array(t.union([t.string(),t.number()])).min(1,{message:"At least one subject must be selected"}).transform(e=>e.map(Number))}),i=t.object({id:t.string().optional(),surname:t.string().min(2,{message:"Surname is required"}),firstname:t.string().min(2,{message:"Name is required"}),admission:t.string().min(3,{message:"Admission number is required"}),sex:t.enum(["MALE","FEMALE"],{message:"Select your gender"}),img:t.string().optional(),phone:t.string().regex(/^\d{7,15}$/,"Enter a valid phone number (7-15 digits)").optional(),address:t.string().optional(),sessionId:t.union([t.string(),t.number()]).transform(e=>Number(e)),termId:t.union([t.string(),t.number()]).transform(e=>Number(e)),gradeId:t.union([t.string(),t.number()]).transform(e=>Number(e)),classId:t.union([t.string(),t.number()]).transform(e=>Number(e)),paymentStatus:t.enum(["PAID","NOT_PAID","PARTIALLY_PAID"],{message:"Select payment status"}),subjects:t.array(t.union([t.string(),t.number()])).min(1,{message:"At least one subject must be selected"}).transform(e=>e.map(Number))}),m=t.object({studentId:t.string().nonempty("Student ID is required"),teacherId:t.string().nonempty("Teacher ID is required"),termId:t.number().min(1,"Term is required"),sessionId:t.number().min(1,"Session is required"),classId:t.number().min(1,"Class is required"),remark:t.string().trim().min(1,"Remark cannot be empty"),position:t.number().min(1,"Position must be greater than 0"),promotion:t.string().optional()});e.exports={studentSchema:i,teacherSchema:n,subjectSchema:a,recordSchema:m}},76386:(e,s,r)=>{r.d(s,{i:()=>a});var t=r(26248);let a=(0,t.createServerReference)("7f313469743f7fd3702663b6525ad8630a911241aa",t.callServer,void 0,t.findSourceMapURL,"updateSubject")},45073:(e,s,r)=>{r.d(s,{F:()=>a});var t=r(26248);let a=(0,t.createServerReference)("7ff0ad8b0367d26620e1348595599f94b06fd8d743",t.callServer,void 0,t.findSourceMapURL,"createSubject")}};