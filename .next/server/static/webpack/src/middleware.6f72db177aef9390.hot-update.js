"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.js":
/*!***************************!*\
  !*** ./src/middleware.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @clerk/nextjs/server */ \"(middleware)/./node_modules/@clerk/nextjs/dist/esm/server/routeMatcher.js\");\n/* harmony import */ var _clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @clerk/nextjs/server */ \"(middleware)/./node_modules/@clerk/nextjs/dist/esm/server/clerkMiddleware.js\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var _lib_settings__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./lib/settings */ \"(middleware)/./src/lib/settings.js\");\n\n\n\n\nconst matchers = Object.keys(_lib_settings__WEBPACK_IMPORTED_MODULE_1__.routeAccessMap).map((route)=>({\n        matcher: (0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_2__.createRouteMatcher)([\n            route\n        ]),\n        allowedRoles: _lib_settings__WEBPACK_IMPORTED_MODULE_1__.routeAccessMap[route]\n    }));\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_3__.clerkMiddleware)(async (auth, req)=>{\n    try {\n        const { sessionId, sessionClaims } = await auth();\n        const role = sessionClaims?.metadata?.role;\n        const path = req.nextUrl.pathname;\n        // console.log('logssss', await auth());\n        // console.log(\"--- Middleware Start ---\");\n        // console.log(\"Middleware - Request URL:\", req.url); // Log full URL\n        // console.log(\"Middleware - Request Pathname:\", path);\n        // console.log(\"Middleware - SessionId:\", sessionId);\n        // console.log(\"Middleware - sessionclaim:\", sessionClaims);\n        // console.log(\"Middleware - Role:\", role);\n        // 1. Public Routes\n        if (_lib_settings__WEBPACK_IMPORTED_MODULE_1__.routeAccessMap[path] === undefined || _lib_settings__WEBPACK_IMPORTED_MODULE_1__.routeAccessMap[path].length === 0) {\n            console.log(\"Middleware - Public Route. Allowing.\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n        }\n        // 2. Authentication Check\n        // if (!sessionId) {\n        //   console.log(\"Middleware - No SessionId. Redirecting to /sign-in\");\n        //   return NextResponse.redirect(new URL('/sign-in', req.url));\n        // }\n        // 3. Role-Based Authorization\n        for (const { matcher, allowedRoles } of matchers){\n            if (matcher(req) && allowedRoles && allowedRoles.length > 0) {\n                // console.log(\"Middleware - Route Match found for pattern:\", matcher.toString()); // Log the matcher pattern\n                // console.log(\"Middleware - Allowed Roles for this route:\", allowedRoles); // Log allowed roles\n                if (!role || !allowedRoles.includes(role)) {\n                    // console.log(\"Middleware - Unauthorized Role:\", role, \"for path:\", path, \". Redirecting to /unauthorized\");\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/unauthorized', req.url));\n                } else {\n                    // console.log(\"Middleware - Authorized Role:\", role, \"for path:\", path, \". Allowing.\");\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n                }\n            } else if (matcher(req)) {\n            // console.log(\"Middleware - Route Match found for pattern:\", matcher.toString(), \"but no roles defined in routeAccessMap.\");\n            }\n        }\n        // 4. Fallback\n        // console.log(\"Middleware - Route not explicitly protected in routeAccessMap, allowing access (Fallback).\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    } catch (error) {\n        // console.error(\"Middleware - Authentication error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/error', req.url));\n    } finally{\n    // console.log(\"--- Middleware End ---\");\n    }\n}));\nconst config = {\n    matcher: [\n        '/((?!_next/static|_next/image|favicon.ico|sign-in|unauthorized|error|api|applynow|aboutMuslimschool|proprietor|[^?]*\\\\.(?:html?|css|js(?!on)|jpe?g|webp|png|gif|svg|ttf|woff2?|ico|csv|docx?|xlsx?|zip|webmanifest)).*)'\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTJFO0FBQ2hDO0FBQ0s7QUFDUjtBQUV4QyxNQUFNSyxXQUFXQyxPQUFPQyxJQUFJLENBQUNKLHlEQUFjQSxFQUFFSyxHQUFHLENBQUNDLENBQUFBLFFBQVU7UUFDekRDLFNBQVNULHdFQUFrQkEsQ0FBQztZQUFDUTtTQUFNO1FBQ25DRSxjQUFjUix5REFBYyxDQUFDTSxNQUFNO0lBQ3JDO0FBRUEsaUVBQWVULHFFQUFlQSxDQUFDLE9BQU9ZLE1BQU1DO0lBQzFDLElBQUk7UUFDRixNQUFNLEVBQUVDLFNBQVMsRUFBRUMsYUFBYSxFQUFFLEdBQUcsTUFBTUg7UUFFM0MsTUFBTUksT0FBTUQsZUFBZUUsVUFBVUQ7UUFDckMsTUFBTUUsT0FBT0wsSUFBSU0sT0FBTyxDQUFDQyxRQUFRO1FBR2pDLHdDQUF3QztRQUd4QywyQ0FBMkM7UUFDM0MscUVBQXFFO1FBQ3JFLHVEQUF1RDtRQUN2RCxxREFBcUQ7UUFDckQsNERBQTREO1FBQzVELDJDQUEyQztRQUUzQyxtQkFBbUI7UUFDbkIsSUFBSWpCLHlEQUFjLENBQUNlLEtBQUssS0FBS0csYUFBYWxCLHlEQUFjLENBQUNlLEtBQUssQ0FBQ0ksTUFBTSxLQUFLLEdBQUc7WUFDM0VDLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU90QixxREFBWUEsQ0FBQ3VCLElBQUk7UUFDMUI7UUFFQSwwQkFBMEI7UUFDMUIsb0JBQW9CO1FBQ3BCLHVFQUF1RTtRQUN2RSxnRUFBZ0U7UUFDaEUsSUFBSTtRQUVKLDhCQUE4QjtRQUM5QixLQUFLLE1BQU0sRUFBRWYsT0FBTyxFQUFFQyxZQUFZLEVBQUUsSUFBSU4sU0FBVTtZQUNoRCxJQUFJSyxRQUFRRyxRQUFRRixnQkFBZ0JBLGFBQWFXLE1BQU0sR0FBRyxHQUFHO2dCQUMzRCw2R0FBNkc7Z0JBQzdHLGdHQUFnRztnQkFDaEcsSUFBSSxDQUFDTixRQUFRLENBQUNMLGFBQWFlLFFBQVEsQ0FBQ1YsT0FBTztvQkFDekMsNkdBQTZHO29CQUM3RyxPQUFPZCxxREFBWUEsQ0FBQ3lCLFFBQVEsQ0FBQyxJQUFJQyxJQUFJLGlCQUFpQmYsSUFBSWdCLEdBQUc7Z0JBQy9ELE9BQU87b0JBQ0wsd0ZBQXdGO29CQUN4RixPQUFPM0IscURBQVlBLENBQUN1QixJQUFJO2dCQUMxQjtZQUNGLE9BQU8sSUFBSWYsUUFBUUcsTUFBTTtZQUN2Qiw2SEFBNkg7WUFDL0g7UUFDRjtRQUVBLGNBQWM7UUFDZCw2R0FBNkc7UUFDN0csT0FBT1gscURBQVlBLENBQUN1QixJQUFJO0lBRTFCLEVBQUUsT0FBT0ssT0FBTztRQUNkLDhEQUE4RDtRQUM5RCxPQUFPNUIscURBQVlBLENBQUN5QixRQUFRLENBQUMsSUFBSUMsSUFBSSxVQUFVZixJQUFJZ0IsR0FBRztJQUN4RCxTQUFVO0lBQ1IseUNBQXlDO0lBQzNDO0FBQ0YsRUFBRSxFQUFDO0FBRUksTUFBTUUsU0FBUztJQUNwQnJCLFNBQVM7UUFDUDtLQUNEO0FBQ0gsRUFBRSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxVU0VSXFxEb2N1bWVudHNcXFByb2dyYW1pbmdcXFNjaG9vbCBNYW5hZ2VtZW50IFN5c3RlbVxcc2Nob29sXFxzcmNcXG1pZGRsZXdhcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2xlcmtNaWRkbGV3YXJlLCBjcmVhdGVSb3V0ZU1hdGNoZXIgfSBmcm9tIFwiQGNsZXJrL25leHRqcy9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCB7IHJvdXRlQWNjZXNzTWFwIH0gZnJvbSBcIi4vbGliL3NldHRpbmdzXCI7XHJcbmltcG9ydCB7IHVzZVVzZXIgfSBmcm9tIFwiQGNsZXJrL25leHRqc1wiO1xyXG5cclxuY29uc3QgbWF0Y2hlcnMgPSBPYmplY3Qua2V5cyhyb3V0ZUFjY2Vzc01hcCkubWFwKHJvdXRlID0+ICh7XHJcbiAgbWF0Y2hlcjogY3JlYXRlUm91dGVNYXRjaGVyKFtyb3V0ZV0pLFxyXG4gIGFsbG93ZWRSb2xlczogcm91dGVBY2Nlc3NNYXBbcm91dGVdXHJcbn0pKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsZXJrTWlkZGxld2FyZShhc3luYyAoYXV0aCwgcmVxKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgc2Vzc2lvbklkLCBzZXNzaW9uQ2xhaW1zIH0gPSBhd2FpdCBhdXRoKCk7XHJcbiAgIFxyXG4gICAgY29uc3Qgcm9sZSA9c2Vzc2lvbkNsYWltcz8ubWV0YWRhdGE/LnJvbGVcclxuICAgIGNvbnN0IHBhdGggPSByZXEubmV4dFVybC5wYXRobmFtZTtcclxuXHJcbiAgXHJcbiAgICAvLyBjb25zb2xlLmxvZygnbG9nc3NzcycsIGF3YWl0IGF1dGgoKSk7XHJcbiAgICBcclxuXHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIi0tLSBNaWRkbGV3YXJlIFN0YXJ0IC0tLVwiKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiTWlkZGxld2FyZSAtIFJlcXVlc3QgVVJMOlwiLCByZXEudXJsKTsgLy8gTG9nIGZ1bGwgVVJMXHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIk1pZGRsZXdhcmUgLSBSZXF1ZXN0IFBhdGhuYW1lOlwiLCBwYXRoKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiTWlkZGxld2FyZSAtIFNlc3Npb25JZDpcIiwgc2Vzc2lvbklkKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiTWlkZGxld2FyZSAtIHNlc3Npb25jbGFpbTpcIiwgc2Vzc2lvbkNsYWltcyk7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIk1pZGRsZXdhcmUgLSBSb2xlOlwiLCByb2xlKTtcclxuXHJcbiAgICAvLyAxLiBQdWJsaWMgUm91dGVzXHJcbiAgICBpZiAocm91dGVBY2Nlc3NNYXBbcGF0aF0gPT09IHVuZGVmaW5lZCB8fCByb3V0ZUFjY2Vzc01hcFtwYXRoXS5sZW5ndGggPT09IDApIHtcclxuICAgICAgY29uc29sZS5sb2coXCJNaWRkbGV3YXJlIC0gUHVibGljIFJvdXRlLiBBbGxvd2luZy5cIik7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDIuIEF1dGhlbnRpY2F0aW9uIENoZWNrXHJcbiAgICAvLyBpZiAoIXNlc3Npb25JZCkge1xyXG4gICAgLy8gICBjb25zb2xlLmxvZyhcIk1pZGRsZXdhcmUgLSBObyBTZXNzaW9uSWQuIFJlZGlyZWN0aW5nIHRvIC9zaWduLWluXCIpO1xyXG4gICAgLy8gICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9zaWduLWluJywgcmVxLnVybCkpO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIDMuIFJvbGUtQmFzZWQgQXV0aG9yaXphdGlvblxyXG4gICAgZm9yIChjb25zdCB7IG1hdGNoZXIsIGFsbG93ZWRSb2xlcyB9IG9mIG1hdGNoZXJzKSB7XHJcbiAgICAgIGlmIChtYXRjaGVyKHJlcSkgJiYgYWxsb3dlZFJvbGVzICYmIGFsbG93ZWRSb2xlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJNaWRkbGV3YXJlIC0gUm91dGUgTWF0Y2ggZm91bmQgZm9yIHBhdHRlcm46XCIsIG1hdGNoZXIudG9TdHJpbmcoKSk7IC8vIExvZyB0aGUgbWF0Y2hlciBwYXR0ZXJuXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJNaWRkbGV3YXJlIC0gQWxsb3dlZCBSb2xlcyBmb3IgdGhpcyByb3V0ZTpcIiwgYWxsb3dlZFJvbGVzKTsgLy8gTG9nIGFsbG93ZWQgcm9sZXNcclxuICAgICAgICBpZiAoIXJvbGUgfHwgIWFsbG93ZWRSb2xlcy5pbmNsdWRlcyhyb2xlKSkge1xyXG4gICAgICAgICAgLy8gY29uc29sZS5sb2coXCJNaWRkbGV3YXJlIC0gVW5hdXRob3JpemVkIFJvbGU6XCIsIHJvbGUsIFwiZm9yIHBhdGg6XCIsIHBhdGgsIFwiLiBSZWRpcmVjdGluZyB0byAvdW5hdXRob3JpemVkXCIpO1xyXG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvdW5hdXRob3JpemVkJywgcmVxLnVybCkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIk1pZGRsZXdhcmUgLSBBdXRob3JpemVkIFJvbGU6XCIsIHJvbGUsIFwiZm9yIHBhdGg6XCIsIHBhdGgsIFwiLiBBbGxvd2luZy5cIik7XHJcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAobWF0Y2hlcihyZXEpKSB7IC8vIEFkZCBsb2cgZm9yIHdoZW4gbWF0Y2hlciBtYXRjaGVzIGJ1dCBubyByb2xlc1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiTWlkZGxld2FyZSAtIFJvdXRlIE1hdGNoIGZvdW5kIGZvciBwYXR0ZXJuOlwiLCBtYXRjaGVyLnRvU3RyaW5nKCksIFwiYnV0IG5vIHJvbGVzIGRlZmluZWQgaW4gcm91dGVBY2Nlc3NNYXAuXCIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gNC4gRmFsbGJhY2tcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiTWlkZGxld2FyZSAtIFJvdXRlIG5vdCBleHBsaWNpdGx5IHByb3RlY3RlZCBpbiByb3V0ZUFjY2Vzc01hcCwgYWxsb3dpbmcgYWNjZXNzIChGYWxsYmFjaykuXCIpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAvLyBjb25zb2xlLmVycm9yKFwiTWlkZGxld2FyZSAtIEF1dGhlbnRpY2F0aW9uIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9lcnJvcicsIHJlcS51cmwpKTtcclxuICB9IGZpbmFsbHkge1xyXG4gICAgLy8gY29uc29sZS5sb2coXCItLS0gTWlkZGxld2FyZSBFbmQgLS0tXCIpO1xyXG4gIH1cclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIG1hdGNoZXI6IFtcclxuICAgICcvKCg/IV9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljb3xzaWduLWlufHVuYXV0aG9yaXplZHxlcnJvcnxhcGl8YXBwbHlub3d8YWJvdXRNdXNsaW1zY2hvb2x8cHJvcHJpZXRvcnxbXj9dKlxcXFwuKD86aHRtbD98Y3NzfGpzKD8hb24pfGpwZT9nfHdlYnB8cG5nfGdpZnxzdmd8dHRmfHdvZmYyP3xpY298Y3N2fGRvY3g/fHhsc3g/fHppcHx3ZWJtYW5pZmVzdCkpLiopJyxcclxuICBdLFxyXG59O1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiY2xlcmtNaWRkbGV3YXJlIiwiY3JlYXRlUm91dGVNYXRjaGVyIiwiTmV4dFJlc3BvbnNlIiwicm91dGVBY2Nlc3NNYXAiLCJ1c2VVc2VyIiwibWF0Y2hlcnMiLCJPYmplY3QiLCJrZXlzIiwibWFwIiwicm91dGUiLCJtYXRjaGVyIiwiYWxsb3dlZFJvbGVzIiwiYXV0aCIsInJlcSIsInNlc3Npb25JZCIsInNlc3Npb25DbGFpbXMiLCJyb2xlIiwibWV0YWRhdGEiLCJwYXRoIiwibmV4dFVybCIsInBhdGhuYW1lIiwidW5kZWZpbmVkIiwibGVuZ3RoIiwiY29uc29sZSIsImxvZyIsIm5leHQiLCJpbmNsdWRlcyIsInJlZGlyZWN0IiwiVVJMIiwidXJsIiwiZXJyb3IiLCJjb25maWciXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.js\n");

/***/ })

});